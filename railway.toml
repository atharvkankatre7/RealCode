[build]
builder = "nixpacks"

[deploy]
numReplicas = 1
sleepApplication = false
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Server service configuration
[[services]]
name = "server"
source = "./server"
dockerfile = "./server/Dockerfile"

[services.env]
NODE_ENV = "production"
ENABLE_TERMINAL = "false"

[services.healthcheck]
path = "/health"
timeout = 30

# Client service configuration  
[[services]]
name = "client"
source = "./client"
dockerfile = "./client/Dockerfile"

[services.env]
NODE_ENV = "production"

[services.healthcheck]
path = "/"
timeout = 30